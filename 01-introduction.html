<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Equipo EDUMER">

<title>introduction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="01-introduction_files/libs/clipboard/clipboard.min.js"></script>
<script src="01-introduction_files/libs/quarto-html/quarto.js"></script>
<script src="01-introduction_files/libs/quarto-html/popper.min.js"></script>
<script src="01-introduction_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="01-introduction_files/libs/quarto-html/anchor.min.js"></script>
<link href="01-introduction_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="01-introduction_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="01-introduction_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="01-introduction_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="01-introduction_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Equipo EDUMER </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Since 1980, economic inequality and wealth concentration have dramatically increased worldwide, becoming one of the main challenges for the social sciences. Globally, in 2021, less than 50% of the world population owned only 2% of the wealth, while the richest 10% concentrated 76%, and the wealthiest 1% captured nearly 38% of total assets <span class="citation" data-cites="chancel_world_2022">(<a href="#ref-chancel_world_2022" role="doc-biblioref">Chancel et al., 2022</a>)</span>. This context of economic disparity has sparked renewed interest in studying not only the objective aspects of inequality, such as income and access to resources, but also its subjective dimensions, including perceptions, beliefs, and associated attitudes <span class="citation" data-cites="janmaat_subjective_2013">(<a href="#ref-janmaat_subjective_2013" role="doc-biblioref">Janmaat, 2013</a>)</span>. This has led, among other reasons, to widespread concern in the social sciences about the political delegitimization that economic inequality can produce <span class="citation" data-cites="castillo_perception_2022">(<a href="#ref-castillo_perception_2022" role="doc-biblioref">Castillo et al., 2022</a>)</span>. Understanding how people perceive inequality is crucial, as these perceptions can influence how societies comprehend and justify the distribution of goods and services.</p>
<p>The perception of economic inequality can be understood as an individual’s subjective assessment of how resources are allocated among members of a given society <span class="citation" data-cites="akyelken_urban_2020">(<a href="#ref-akyelken_urban_2020" role="doc-biblioref">Akyelken, 2020</a>)</span>. Regardless of their measurement, various studies have shown that this perception often underestimates the gap between the rich and the poor, which could have implications for attitudes toward the distribution of goods and services <span class="citation" data-cites="castillo_perception_2022 schroder_income_2017">(<a href="#ref-castillo_perception_2022" role="doc-biblioref">Castillo et al., 2022</a>; <a href="#ref-schroder_income_2017" role="doc-biblioref">Schröder, 2017</a>)</span>. Moreover, in recent years, there has been a discussion about the subjective and objective aspects of inequality, demonstrating inconsistencies between the two <span class="citation" data-cites="trump_income_2018">(<a href="#ref-trump_income_2018" role="doc-biblioref">Trump, 2018</a>)</span>. This tension is relevant because advancing the study of perceptions could help understand how perceived inequality affects the distribution of resources within a society (Becker, 2020).</p>
<p>Perception of economic inequality has been associated with important outcomes such as redistributive preferences, justification of inequality, and legitimacy of the economic system (Castillo et al., 2022 [acá citar gente de Granada]). Research shows that greater perceived inequality fosters stronger preferences for redistribution, regardless of actual inequality levels <span class="citation" data-cites="garcia-sanchez_vicious_2019 gimpelson_misperceiving_2018">(<a href="#ref-garcia-sanchez_vicious_2019" role="doc-biblioref">García-Sánchez et al., 2019</a>; <a href="#ref-gimpelson_misperceiving_2018" role="doc-biblioref">Gimpelson &amp; Treisman, 2018</a>)</span>. However, other findings suggest that heightened perceptions of income gaps between high- and low-paying occupations may lead to greater justification of inequality <span class="citation" data-cites="Castillo2011">(<a href="#ref-Castillo2011" role="doc-biblioref">Castillo, 2011</a>)</span>. A less explored area in this regard concerns market justice, which denotes the degree to which individuals consider just that social goods and services (e.g., health, pensions, education) are allocated according to individual contribution, competition, and ability to pay <span class="citation" data-cites="lane_market_1986 lindh_public_2015 kluegel_legitimation_1999">(<a href="#ref-kluegel_legitimation_1999" role="doc-biblioref">Kluegel et al., 1999</a>; <a href="#ref-lane_market_1986" role="doc-biblioref">Lane, 1986</a>; <a href="#ref-lindh_public_2015" role="doc-biblioref">Lindh, 2015</a>)</span>. Market justice attitudes reflect the belief that the market promotes procedural fairness—equality of opportunity—so that outcomes result from individual achievement [-<span class="citation" data-cites="lane_market_1986">Lane (<a href="#ref-lane_market_1986" role="doc-biblioref">1986</a>)</span>]. Indeed, Lindh <span class="citation" data-cites="lindh_public_2015">(<a href="#ref-lindh_public_2015" role="doc-biblioref">2015</a>)</span> shows that market justice preferences are stronger in countries with higher private spending on services than in those with more comprehensive welfare systems. From this perspective, perceptions of economic inequality may be key, as lower perceived gaps can reinforce acceptance of free-market systems and justify existing inequalities.</p>
<p>Meritocracy posits that inequality is an inherent feature of societies but can be legitimized through fairer principles, such as effort and talent <span class="citation" data-cites="young_rise_1962 davis_principles_2001">(<a href="#ref-davis_principles_2001" role="doc-biblioref">Davis &amp; Moore, 2001</a>; <a href="#ref-young_rise_1962" role="doc-biblioref">Young, 1962</a>)</span>. Previous studies have demonstrated that people with stronger meritocratic beliefs tend to perceive less inequality as they attribute economic differences to individual achievements <span class="citation" data-cites="mijs_paradox_2021 wilson_role_2003">(<a href="#ref-mijs_paradox_2021" role="doc-biblioref">Mijs, 2021</a>; <a href="#ref-wilson_role_2003" role="doc-biblioref">Wilson, 2003</a>)</span> and also to justify more inequality since these beliefs are associated with attitudes that maintain the legitimization of social differences <span class="citation" data-cites="batruch_belief_2023">(<a href="#ref-batruch_belief_2023" role="doc-biblioref">Batruch et al., 2023</a>)</span>. In a context like Chile, where the distribution of goods and services is predominantly governed by market logics strongly introduced during the military dictatorship (1973-1989) <span class="citation" data-cites="boccardo_30_2020">(<a href="#ref-boccardo_30_2020" role="doc-biblioref">Boccardo, 2020</a>)</span>, these beliefs can play a crucial role in the acceptance of social inequalities. Incorporating the perception of meritocracy in this literature allows for an understanding of how attitudes toward inequality are shaped not only by the perception of economic gaps, but also by beliefs about how these gaps are justified. Furthermore, these beliefs are often consolidated from an early age, reinforced by institutions promoting values such as effort and individual skills to climb socially <span class="citation" data-cites="castillo_socialization_2024 reynolds_perceptions_2014">(<a href="#ref-castillo_socialization_2024" role="doc-biblioref">Castillo et al., 2024</a>; <a href="#ref-reynolds_perceptions_2014" role="doc-biblioref">Reynolds &amp; Xian, 2014</a>)</span>.</p>
<p>The perception of meritocracy and the perception of economic inequality would interact intricately in shaping preferences for market justice. On the one hand, a stronger perception of merit as a criterion for distribution could minimize the perception of economic gaps, thus justifying an unequal system <span class="citation" data-cites="castillo_percepcion_2019 mijs_paradox_2021">(<a href="#ref-castillo_percepcion_2019" role="doc-biblioref">Castillo et al., 2012</a>; <a href="#ref-mijs_paradox_2021" role="doc-biblioref">Mijs, 2021</a>)</span>. On the other hand, the perception of inequality could moderate the impact of meritocracy, as a higher perception of economic gaps might challenge the idea that these are solely based on merit.</p>
<p>The primary objective of this study is to analyze the interplay between perceptions of inequality and meritocracy and their joint influence on preferences for market justice in Chile from 2016 to 2023, using longitudinal data from the ELSOC survey. This interaction is expected to provide a more comprehensive explanation of attitudes toward market justice in a country characterized by high inequality and strong free-market influence <span class="citation" data-cites="boccardo_30_2020 flores_top_2020">(<a href="#ref-boccardo_30_2020" role="doc-biblioref">Boccardo, 2020</a>; <a href="#ref-flores_top_2020" role="doc-biblioref">Flores et al., 2020</a>)</span>. Additionally, this analysis seeks to elucidate how political and social contingencies—such as the 2019 and 2022 social movements—might have moderated these relationships by prompting more critical reflection on the commodification of social services. Recognizing the temporal dimension in shaping market justice preferences is essential, given that such preferences are not static but are influenced by historical and contextual factors that challenge or reaffirm prevailing social norms. In this regard, variations in perceived economic inequality and meritocracy over time can affect how individuals endorse market-based approaches. Consequently, public opinion may shift from supporting market justice to embracing redistributive policies aimed at mitigating inequalities.</p>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-akyelken_urban_2020" class="csl-entry" role="listitem">
Akyelken, N. (2020). Urban conceptions of economic inequalities. <em>Regional Studies</em>, <em>54</em>(6), 863–872. <a href="https://doi.org/10.1080/00343404.2020.1732902">https://doi.org/10.1080/00343404.2020.1732902</a>
</div>
<div id="ref-batruch_belief_2023" class="csl-entry" role="listitem">
Batruch, A., Jetten, J., Van De Werfhorst, H., Darnon, C., &amp; Butera, F. (2023). Belief in <span>School Meritocracy</span> and the <span>Legitimization</span> of <span>Social</span> and <span>Income Inequality</span>. <em>Social Psychological and Personality Science</em>, <em>14</em>(5), 621–635. <a href="https://doi.org/10.1177/19485506221111017">https://doi.org/10.1177/19485506221111017</a>
</div>
<div id="ref-boccardo_30_2020" class="csl-entry" role="listitem">
Boccardo, G. (2020). <em>30 a<span>ñ</span>os de privatizaciones en <span>Chile</span>: Lo que la pandemia revel<span>ó</span></em> (Nodo XXI). Santiago.
</div>
<div id="ref-Castillo2011" class="csl-entry" role="listitem">
Castillo, J. C. (2011). Legitimacy of <span>Inequality</span> in a <span>Highly Unequal Context</span>: <span>Evidence</span> from the <span>Chilean Case</span>. <em>Social Justice Research</em>, <em>24</em>(4), 314–340. <a href="https://doi.org/10.1007/s11211-011-0144-5">https://doi.org/10.1007/s11211-011-0144-5</a>
</div>
<div id="ref-castillo_perception_2022" class="csl-entry" role="listitem">
Castillo, J. C., García-Castro, J.-D., &amp; Venegas, M. (2022). Perception of economic inequality: Concepts, associated factors and prospects of a burgeoning research agenda. <em>International Journal of Social Psychology</em>, <em>37</em>(1), 180–207. <a href="https://doi.org/10.1080/02134748.2021.2009275">https://doi.org/10.1080/02134748.2021.2009275</a>
</div>
<div id="ref-castillo_percepcion_2019" class="csl-entry" role="listitem">
Castillo, J. C., Miranda, D., &amp; Carrasco, D. (2012). Percepci<span>ó</span>n de <span class="nocase">Desigualdad Econ<span class="nocase">ó</span>mica</span> en <span>Chile</span>: <span class="nocase">Medici<span class="nocase">ó</span>n</span>, <span>Diferencias</span> y <span>Determinantes</span>. <em>Psykhe (Santiago)</em>, <em>21</em>(1), 99–114. <a href="https://doi.org/10.4067/S0718-22282012000100007">https://doi.org/10.4067/S0718-22282012000100007</a>
</div>
<div id="ref-castillo_socialization_2024" class="csl-entry" role="listitem">
Castillo, J. C., Salgado, M., Carrasco, K., &amp; Laffert, A. (2024). The <span>Socialization</span> of <span>Meritocracy</span> and <span>Market Justice Preferences</span> at <span>School</span>. <em>Societies</em>, <em>14</em>(11), 214. <a href="https://doi.org/10.3390/soc14110214">https://doi.org/10.3390/soc14110214</a>
</div>
<div id="ref-chancel_world_2022" class="csl-entry" role="listitem">
Chancel, L., Piketty, T., Saez, E., &amp; Zucman, G. (2022). World inequality report 2022. https://bibliotecadigital.ccb.org.co/handle/11520/27510.
</div>
<div id="ref-davis_principles_2001" class="csl-entry" role="listitem">
Davis, K., &amp; Moore, W. E. (2001). Some <span>Principles</span> of <span>Stratification</span>. In <em>Social <span>Stratification</span>, <span>Class</span>, <span>Race</span>, and <span>Gender</span> in <span>Sociological Perspective</span>, <span>Second Edition</span></em> (2nd ed.). Routledge.
</div>
<div id="ref-flores_top_2020" class="csl-entry" role="listitem">
Flores, I., Sanhueza, C., Atria, J., &amp; Mayer, R. (2020). Top <span>Incomes</span> in <span>Chile</span>: <span>A Historical Perspective</span> on <span>Income Inequality</span>, 1964–2017. <em>Review of Income and Wealth</em>, <em>66</em>(4), 850–874. <a href="https://doi.org/10.1111/roiw.12441">https://doi.org/10.1111/roiw.12441</a>
</div>
<div id="ref-garcia-sanchez_vicious_2019" class="csl-entry" role="listitem">
García-Sánchez, E., Van Der Toorn, J., Rodríguez-Bailón, R., &amp; Willis, G. B. (2019). The <span>Vicious Cycle</span> of <span>Economic Inequality</span>: <span>The Role</span> of <span>Ideology</span> in <span>Shaping</span> the <span>Relationship Between</span> <span>“<span>What Is</span>”</span> and <span>“<span>What Ought</span> to <span>Be</span>”</span> in 41 <span>Countries</span>. <em>Social Psychological and Personality Science</em>, <em>10</em>(8), 991–1001. <a href="https://doi.org/10.1177/1948550618811500">https://doi.org/10.1177/1948550618811500</a>
</div>
<div id="ref-gimpelson_misperceiving_2018" class="csl-entry" role="listitem">
Gimpelson, V., &amp; Treisman, D. (2018). Misperceiving inequality. <em>Economics &amp; Politics</em>, <em>30</em>(1), 27–54. <a href="https://doi.org/10.1111/ecpo.12103">https://doi.org/10.1111/ecpo.12103</a>
</div>
<div id="ref-janmaat_subjective_2013" class="csl-entry" role="listitem">
Janmaat, J. G. (2013). Subjective inequality: <span>A</span> review of international comparative studies on people’s views about inequality. <em>Archives Europeennes de Sociologie</em>, <em>54</em>(3), 357–389. <a href="https://doi.org/10.1017/S0003975613000209">https://doi.org/10.1017/S0003975613000209</a>
</div>
<div id="ref-kluegel_legitimation_1999" class="csl-entry" role="listitem">
Kluegel, J. R., Mason, D. S., &amp; Wegener, B. (1999). The <span>Legitimation</span> of <span>Capitalism</span> in the <span>Postcommunist Transition</span>: <span>Public Opinion</span> about <span>Market Justice</span>, 1991-1996. <em>European Sociological Review</em>, <em>15</em>(3), 251–283. Retrieved from <a href="https://www.jstor.org/stable/522731">https://www.jstor.org/stable/522731</a>
</div>
<div id="ref-lane_market_1986" class="csl-entry" role="listitem">
Lane, R. E. (1986). Market <span>Justice</span>, <span>Political Justice</span>. <em>American Political Science Review</em>, <em>80</em>(2), 383–402. <a href="https://doi.org/10.2307/1958264">https://doi.org/10.2307/1958264</a>
</div>
<div id="ref-lindh_public_2015" class="csl-entry" role="listitem">
Lindh, A. (2015). Public <span>Opinion</span> against <span>Markets</span>? <span>Attitudes</span> towards <span>Market Distribution</span> of <span>Social Services</span> – <span>A Comparison</span> of 17 <span>Countries</span>. <em>Social Policy &amp; Administration</em>, <em>49</em>(7), 887–910. <a href="https://doi.org/10.1111/spol.12105">https://doi.org/10.1111/spol.12105</a>
</div>
<div id="ref-mijs_paradox_2021" class="csl-entry" role="listitem">
Mijs, J. (2021). The paradox of inequality: Income inequality and belief in meritocracy go hand in hand. <em>Socio-Economic Review</em>, <em>19</em>(1), 7–35. <a href="https://doi.org/10.1093/ser/mwy051">https://doi.org/10.1093/ser/mwy051</a>
</div>
<div id="ref-reynolds_perceptions_2014" class="csl-entry" role="listitem">
Reynolds, J., &amp; Xian, H. (2014). Perceptions of meritocracy in the land of opportunity. <em>Research in Social Stratification and Mobility</em>, <em>36</em>, 121–137. <a href="https://doi.org/10.1016/j.rssm.2014.03.001">https://doi.org/10.1016/j.rssm.2014.03.001</a>
</div>
<div id="ref-schroder_income_2017" class="csl-entry" role="listitem">
Schröder, M. (2017). Is <span>Income Inequality Related</span> to <span>Tolerance</span> for <span>Inequality</span>? <em>Social Justice Research</em>, <em>30</em>(1), 23–47. <a href="https://doi.org/10.1007/s11211-016-0276-8">https://doi.org/10.1007/s11211-016-0276-8</a>
</div>
<div id="ref-trump_income_2018" class="csl-entry" role="listitem">
Trump, K.-S. (2018). Income <span>Inequality Influences Perceptions</span> of <span>Legitimate Income Differences</span>. <em>British Journal of Political Science</em>, <em>48</em>(4), 929–952. <a href="https://doi.org/10.1017/S0007123416000326">https://doi.org/10.1017/S0007123416000326</a>
</div>
<div id="ref-wilson_role_2003" class="csl-entry" role="listitem">
Wilson, C. (2003). The <span>Role</span> of a <span>Merit Principle</span> in <span>Distributive Justice</span>. <em>The Journal of Ethics</em>, <em>7</em>(3), 277–314. <a href="https://doi.org/10.1023/A:1024667228488">https://doi.org/10.1023/A:1024667228488</a>
</div>
<div id="ref-young_rise_1962" class="csl-entry" role="listitem">
Young, M. (1962). <em>The rise of the meritocracy</em>. Baltimore: Penguin Books.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>