---
author: "Equipo EDUMER"
bibliography: "input/bib/merit-edjust.bib"
csl: "input/bib/apa6.csl"
---

```{r}
#| echo: false
#| message: false
#| warning: false

library(knitr)
knitr::opts_chunk$set(echo = TRUE, include = TRUE, warning = FALSE, message = FALSE)

table_format <- if(is_html_output()) {
  "html"
} else if(is_latex_output()) {
  "latex"
}
table_format2 <- if(is_html_output()) {
  T
} else if(is_latex_output()) {
  F
}

options(kableExtra.html.bsTable = T)
options(knitr.kable.NA = "")
```

```{r}
#| label: packages
#| include: true
#| echo: false

if (! require("pacman")) install.packages("pacman")

pacman::p_load(tidyverse, 
               sjmisc, 
               sjPlot, 
               lme4, 
               here, 
               performance,
               influence.ME, 
               marginaleffects,
               MLMusingR,
               texreg, 
               ggdist,
               misty,
               kableExtra,
               ggalluvial, 
               shadowtext,
               MetBrewer,
               patchwork,
               sjlabelled,
               summarytools)


options(scipen=999)
rm(list = ls())
```

```{r}
#| label: data
#| echo: false
#| include: false 

load(file = here("input/data/proc/df_study1_long_t7.RData"))

glimpse(df_study1_long_t7)

# Generate analytical sample

df_study1 <- df_study1_long_t7 %>%
  select(idencuesta,
         ola,
         ponderador_long_total,
         segmento,
         estrato,
         just_health,
         just_pension,
         just_educ,
         mjp, 
         perc_inequality, 
         just_inequality,
         merit_effort, 
         merit_talent, 
         educ,
         quintil1,
         sex,
         age,
         ess, 
         ideo) %>% 
  na.omit() %>% 
  mutate(ola = as.factor(ola),
         ola_num = as.numeric(ola),
         ola_2=as.numeric(ola)^2)

df_study1 <- df_study1 %>%
  group_by(idencuesta) %>%             # Agrupar por el identificador del participante
  mutate(n_participaciones = n()) %>%  # Contar el número de filas (participaciones) por participante
  ungroup()

df_study1 <- df_study1 %>% filter(n_participaciones>1)

# Corregir etiquetas

df_study1$just_health <- sjlabelled::set_label(df_study1$just_health, 
                        label = "Health distributive justice")

df_study1$just_pension <- sjlabelled::set_label(df_study1$just_pension, 
                        label = "Pension distributive justice")

df_study1$just_educ <- sjlabelled::set_label(df_study1$just_educ, 
                        label = "Education distributive justice")

df_study1$merit_effort <- sjlabelled::set_label(df_study1$merit_effort, 
                        label = "People are rewarded for their efforts")

df_study1$merit_talent <- sjlabelled::set_label(df_study1$merit_talent, 
                        label = "People are rewarded for their intelligence")

```
# Results

## Descriptive 


@fig-alluvial shows the annual frequencies of market justice preferences for healthcare, pensions, and education from 2016 to 2023. Each year presents stacked percentage frequencies, and the flows between them reflect opinion changes among the same individuals from one year to the next, given that we are using panel data. For instance, of the 40.9% who strongly disagreed with justifying inequality in healthcare in 2019, around 24.3% maintained that position in 2022, while the remaining 16.6% shifted toward other response categories—primarily moving into disagreement rather than strong disagreement. Overall, more than half of the respondents exhibit a high level of disagreement (disagree + strongly disagree) with inequality in these three social service areas over time. Despite this general pattern, recent waves show a slight decrease in disagreement and a corresponding rise in support for inequality. Specifically, in healthcare and education, although disagreement remains substantial, agreement increased from 8.9% and 7.6% in 2019 to 12% and 12.5% in 2023, respectively. This shift is most evident in pensions, where the combined agree/strongly agree category grew by about 10 percentage points, from 16.9% in 2016 to 27.8% in 2023.

```{r}
#| label: fig-alluvial
#| out-width: '100%'
#| fig-asp: 1
#| fig-cap: "Change in the justification of inequality in health, pensions and education over time (2016-2023)"
#| fig-cap-location: top
#| echo: false
#| results: asis


datos.health <- df_study1 %>% 
  mutate(just_health = factor(just_health, 
                              levels = c("Strongly agree",
                                         "Agree",
                                         "Neither agree nor desagree",
                                         "Desagree",
                                         "Strongly desagree"))) %>% 
  group_by(idencuesta, ola) %>% 
  count(just_health) %>% 
  group_by(ola) %>% 
  mutate(porcentaje=n/sum(n)) %>% 
  ungroup() %>% 
  na.omit() %>% 
  mutate(wave = case_when(ola == 1 ~ "2016",
                          ola == 2 ~ "2017",
                          ola == 3 ~ "2018",
                          ola == 4 ~ "2019",
                          ola == 6 ~ "2022",
                          ola == 7 ~ "2023"),
         wave = factor(wave, levels = c("2016",
                                      "2017",
                                      "2018",
                                      "2019",
                                      "2022",
                                      "2023")))



etiquetas.health <- df_study1 %>%
  mutate(just_health = factor(just_health, 
                              levels = c("Strongly agree",
                                         "Agree",
                                         "Neither agree nor desagree",
                                         "Desagree",
                                         "Strongly desagree"))) %>% 
  group_by(ola, just_health) %>%
  summarise(count = n(), .groups = "drop") %>%
  group_by(ola) %>%
  mutate(porcentaje = count / sum(count)) %>% 
  na.omit() %>% 
  mutate(idencuesta = 1,
         wave = case_when(ola == 1 ~ "2016",
                          ola == 2 ~ "2017",
                          ola == 3 ~ "2018",
                          ola == 4 ~ "2019",
                          ola == 6 ~ "2022",
                          ola == 7 ~ "2023"),
         wave = factor(wave, levels = c("2016",
                                        "2017",
                                        "2018",
                                        "2019",
                                        "2022",
                                        "2023")))




p1 <- datos.health %>% 
  ggplot(aes(x = wave, fill = just_health, stratum = just_health,
             alluvium = idencuesta, y = porcentaje)) +
  ggalluvial::geom_flow(alpha = .4) + 
  ggalluvial::geom_stratum(linetype = 0) +
  scale_y_continuous(labels = scales::percent) + 
  scale_fill_manual(values =  c("#0571B0","#92C5DE","#b3b3b3ff","#F4A582","#CA0020")) +
  geom_shadowtext(data = etiquetas.health,
                  aes(label = ifelse(porcentaje > 0 , scales::percent(porcentaje, accuracy = .1),"")),
                  position = position_stack(vjust = .5),
                  show.legend = FALSE,
                  size = 3,
                  color = rep('white'),
                  bg.colour='grey30')+
  labs(y = "%",
       x = "Wave",
       fill = NULL,
       title = "a. Health") +
  theme_ggdist() +
  theme(legend.position = "none") 
  


datos.pension <- df_study1 %>% 
   mutate(just_pension = factor(just_pension, 
                              levels = c("Strongly agree",
                                         "Agree",
                                         "Neither agree nor desagree",
                                         "Desagree",
                                         "Strongly desagree"))) %>% 
  group_by(idencuesta, ola) %>% 
  count(just_pension) %>% 
  group_by(ola) %>% 
  mutate(porcentaje=n/sum(n)) %>% 
  ungroup() %>% 
  na.omit() %>% 
  mutate(wave = case_when(ola == 1 ~ "2016",
                          ola == 2 ~ "2017",
                          ola == 3 ~ "2018",
                          ola == 4 ~ "2019",
                          ola == 6 ~ "2022",
                          ola == 7 ~ "2023"),
         wave = factor(wave, levels = c("2016",
                                        "2017",
                                        "2018",
                                        "2019",
                                        "2022",
                                        "2023")))



etiquetas.pension <- df_study1 %>%
  mutate(just_pension = factor(just_pension, 
                              levels = c("Strongly agree",
                                         "Agree",
                                         "Neither agree nor desagree",
                                         "Desagree",
                                         "Strongly desagree"))) %>% 
  group_by(ola, just_pension) %>%
  summarise(count = n(), .groups = "drop") %>%
  group_by(ola) %>%
  mutate(porcentaje = count / sum(count)) %>% 
  na.omit() %>% 
  mutate(idencuesta = 1,
         wave = case_when(ola == 1 ~ "2016",
                          ola == 2 ~ "2017",
                          ola == 3 ~ "2018",
                          ola == 4 ~ "2019",
                          ola == 6 ~ "2022",
                          ola == 7 ~ "2023"),
         wave = factor(wave, levels = c("2016",
                                        "2017",
                                        "2018",
                                        "2019",
                                        "2022",
                                        "2023")))

p2 <- datos.pension %>% 
  ggplot(aes(x = wave, fill = just_pension, stratum = just_pension,
             alluvium = idencuesta, y = porcentaje)) +
  ggalluvial::geom_flow(alpha = .4) + 
  ggalluvial::geom_stratum(linetype = 0) +
  scale_y_continuous(labels = scales::percent) + 
  scale_fill_manual(values =  c("#0571B0","#92C5DE","#b3b3b3ff","#F4A582","#CA0020")) +
  geom_shadowtext(data = etiquetas.pension,
                  aes(label = ifelse(porcentaje > 0 , scales::percent(porcentaje, accuracy = .1),"")),
                  position = position_stack(vjust = .5),
                  show.legend = FALSE,
                  size = 3,
                  color = rep('white'),
                  bg.colour='grey30')+
  labs(y = "%",
       x = "Wave",
       fill = NULL,
       title = "b. Pension") +
  theme_ggdist() +
  theme(legend.position = "none") 


datos.educ <- df_study1 %>% 
  mutate(just_educ = factor(just_educ, 
                              levels = c("Strongly agree",
                                         "Agree",
                                         "Neither agree nor desagree",
                                         "Desagree",
                                         "Strongly desagree"))) %>%
  group_by(idencuesta, ola) %>% 
  count(just_educ) %>% 
  group_by(ola) %>% 
  mutate(porcentaje=n/sum(n)) %>% 
  ungroup() %>% 
  na.omit() %>% 
  mutate(wave = case_when(ola == 1 ~ "2016",
                          ola == 2 ~ "2017",
                          ola == 3 ~ "2018",
                          ola == 4 ~ "2019",
                          ola == 6 ~ "2022",
                          ola == 7 ~ "2023"),
         wave = factor(wave, levels = c("2016",
                                        "2017",
                                        "2018",
                                        "2019",
                                        "2022",
                                        "2023")))



etiquetas.educ <- df_study1 %>%
    mutate(just_educ = factor(just_educ, 
                              levels = c("Strongly agree",
                                         "Agree",
                                         "Neither agree nor desagree",
                                         "Desagree",
                                         "Strongly desagree"))) %>%
  group_by(ola, just_educ) %>%
  summarise(count = n(), .groups = "drop") %>%
  group_by(ola) %>%
  mutate(porcentaje = count / sum(count)) %>% 
  na.omit() %>% 
  mutate(idencuesta = 1,
         wave = case_when(ola == 1 ~ "2016",
                          ola == 2 ~ "2017",
                          ola == 3 ~ "2018",
                          ola == 4 ~ "2019",
                          ola == 6 ~ "2022",
                          ola == 7 ~ "2023"),
         wave = factor(wave, levels = c("2016",
                                        "2017",
                                        "2018",
                                        "2019",
                                        "2022",
                                        "2023")))

p3 <- datos.educ %>% 
  ggplot(aes(x = wave, fill = just_educ, stratum = just_educ,
             alluvium = idencuesta, y = porcentaje)) +
  ggalluvial::geom_flow(alpha = .4) + 
  ggalluvial::geom_stratum(linetype = 0) +
  scale_y_continuous(labels = scales::percent) + 
  scale_fill_manual(values =  c("#0571B0","#92C5DE","#b3b3b3ff","#F4A582","#CA0020")) +
  geom_shadowtext(data = etiquetas.educ,
                  aes(label = ifelse(porcentaje > 0 , scales::percent(porcentaje, accuracy = .1),"")),
                  position = position_stack(vjust = .5),
                  show.legend = FALSE,
                  size = 3,
                  color = rep('white'),
                  bg.colour='grey30')+
  labs(y = "%",
       x = "Wave",
       fill = NULL,
       title = "c. Education",
       caption = "Source: own elaboration with pooled data from ELSOC 2016-2023 (n = 8460)") +
  theme_ggdist() +
  theme(legend.position = "bottom") 

(p1 / p2 / p3) 

```


Regarding the main variables of this study, @fig-meanchange depicts their average changes over the years. We observe an increase in the average level of market justice preferences in the most recent waves, which begins in 2019. The highest average consistently appears for perceived economic inequality, although this variable shows a downward trend of roughly one point over time. Interestingly, while perceptions of economic inequality declined in the latest measurements (2022–2023), market justice preferences increased. With respect to economic inequality justification, there is a steady decrease in average levels over the years, registering the lowest mean compared to the other variables. The meritocracy measures remain stable, though the perception that individuals are rewarded for intelligence is slightly higher than the perception that they are rewarded for their effort.

```{r}
#| label: fig-meanchange
#| out-width: '100%'
#| fig-asp: 1
#| fig-cap: "Change in the mean of market justice preferences, economic inequality perception and justification, and meritocracy (2016-2023)"
#| fig-cap-location: top
#| echo: false
#| results: asis
library(srvyr)

df_pond <- df_study1 %>% 
  mutate(ola = case_when(ola == 1 ~ "2016",
                         ola == 2 ~ "2017",
                         ola == 3 ~ "2018",
                         ola == 4 ~ "2019",
                         ola == 6 ~ "2022",
                         ola == 7 ~ "2023"),
         ola = factor(ola, levels = c("2016",
                                        "2017",
                                        "2018",
                                        "2019",
                                        "2022",
                                        "2023"))) %>% 
  as_survey_design(.data = .,
                   ids = segmento, 
                   strata = estrato, 
                   weights = ponderador_long_total)

df_pond %>% 
  select(ola, mjp, perc_inequality, just_inequality, merit_effort, merit_talent) %>% 
  mutate_at(.vars = 2:6, .funs = ~ as.numeric(.)) %>% 
  group_by(ola) %>% 
  summarise_all(~survey_mean(., vartype = "ci")) %>% 
  pivot_longer(cols = -ola,
               names_to = "temp",
               values_to = "valor") %>%
  mutate(
    ci = case_when(
      str_ends(temp, "_low") ~ "ic_low",
      str_ends(temp, "_upp") ~ "ic_upp",
      TRUE                   ~ "mean"
    ),
    variable = str_remove(temp, "_low|_upp")
  ) %>%
  select(ola, variable, ci, valor) %>%
  pivot_wider(
    names_from  = ci,
    values_from = valor
  ) %>% 
  mutate(variable = case_when(variable == "mjp" ~ "Market justice preferences",
                              variable == "perc_inequality"  ~ "Inequality perception",
                              variable == "just_inequality"  ~ "Inequality justification",
                              variable == "merit_effort"     ~ "Merit: Effort",
                              variable == "merit_talent"     ~ "Merit: Talent"),
         variable = factor(variable, levels = c("Market justice preferences",
                                      "Inequality perception",
                                      "Inequality justification",
                                      "Merit: Effort",
                                      "Merit: Talent")
                              )) %>% 
  ggplot(aes(x = ola, y = mean, group = variable)) +
  geom_point(aes(shape=variable, color=variable), size = 3.5) +
  geom_line(aes(color = variable), linewidth = 0.8) +
  geom_errorbar(aes(ymin = ic_low, ymax = ic_upp, color = variable),
                width = 0.1) +
  scale_color_manual(values = c("#023858", # azul oscuro
                                "#0571B0", # azul intermedio
                                "#b3b3b3", # gris
                                "#F4A582", # salmón
                                "#B2182B"  # rojo profundo
                                         )) +
  scale_shape_manual(values=c(15, 16, 17, 18, 4)) +
  labs(y = "Mean",
       x = "Wave",
       color = NULL,
       shape = NULL,
       caption = "Source: own elaboration with pooled data from ELSOC 2016-2023 (n = 8460)") +
  theme_ggdist() +
  theme(legend.position = "top",
        text = element_text(size = 12)) 
 
```

@fig-matrix presents the correlation matrix for the main variables in the latest wave (2023). Overall, the coefficients range from low to moderate. The association between market justice preferences and economic inequality perception is negative but small and not statistically significant ($r$ = -0.05, $p$ > .05). By contrast, market justice preferences positively and significantly correlate with the justification of economic inequality ($r$ = 0.16, $p$ < .01), as well as show low, positive associations with the two meritocracy variables ($r$ = 0.14, $p$ < .01; $r$ = 0.12, $p$ < .01). Perceived economic inequality has a strong, positive correlation with justifying economic inequality ($r$ = 0.53, $p$ < .01), but negative and nonsignificant correlations with both meritocracy perceptions ($r$ = -0.04, $p$ > .05; $r$ = -0.04, $p$ > .05). The justification of economic inequality indicator also has small yet statistically significant positive correlations with the meritocracy variables ($r$ = 0.05, $p$ < .05; $r$ = 0.07, $p$ < .01). Finally, the two meritocracy variables exhibit a strong positive association with each other ($r$ = 0.69, $p$ < .01).


```{r}
#| label: fig-matrix
#| out-width: '100%'
#| fig-asp: 1
#| fig-cap: "Correlation matrix of the main variables for the last wave (2023)"
#| fig-cap-location: top
#| echo: false
#| results: asis


M <- df_study1 %>%
  filter(ola == 7) %>% 
  select(mjp, perc_inequality, just_inequality, merit_effort, merit_talent) %>% 
  mutate_all(.funs = ~ as.numeric(.)) %>% 
  cor(use = "pairwise.complete.obs", method = "pearson")

diag(M) <- NA

rownames(M) <- c("A. Marjet justice preferences",
                 "B. Inequality gap perception",
                 "C. Inequality gap justification",
                 "D. People are rewarded for their efforts ",
                 "E. People are rewarded for their intelligence")

#set Column names of the matrix
colnames(M) <-c("(A)", "(B)","(C)","(D)","(E)")

#Plot the matrix using corrplot
corrplot::corrplot(M,
                   method = "color",
                   addCoef.col = "black",
                   type = "upper",
                   tl.col = "black",
                   col = colorRampPalette(c("#E16462", "white", "#0D0887"))(12),
                   bg = "white",
                   na.label = "-") 

```


## Multilevel models

@tbl-modelos presents the results of the multilevel models estimated for market justice preferences, examining both individuals (within) and group-level (between) effects. The intraclass correlation [ICC, @hoxMultilevelAnalysisTechniques2017] from the empty model (see Supplementary Material), which decomposes the variance of market justice preferences, is 0.23, indicating that approximately 23% of the variation is attributable to differences between individuals. Complementary, 77% of the variation corresponds to within-individual differences over time.

According to Model 1, which includes the survey waves to capture intertemporal variations in the dependent variable, there is a decrease in 2017 ($\beta$ = -0.162, $p$ < .001) relative to 2016, and similarly in 2018 ($\beta$ = -0.015, $p$ > .05) and 2019 ($\beta$ = -0.041, $p$ > .05), although the latter effects are not statistically significant. In contrast, in the more recent waves of 2022 and 2023, there is a statistically significant increase in market justice preferences ($\beta$ = 0.289, $p$ < .001; $\beta$ = 0.286, $p$ < .001), suggesting a non-linear effect. To model this trajectory over time, Model 2 incorporates time (survey waves) as a continuous variable, along with its quadratic term, representing the non-linear association initially observed in Model 1. While the linear term (survey wave) shows a negative association, reflecting an overall decline in market preferences over time, the positive quadratic term indicates a reversal of this pattern in the final measurement points.



```{r, echo=FALSE, include=FALSE}

df_study1$merit_effort <- as_numeric(df_study1$merit_effort)
df_study1$merit_talent <- as_numeric(df_study1$merit_talent)

df_study1 <- df_study1 %>% 
  mutate(ola = case_when(ola == 1 ~ "2016",
                         ola == 2 ~ "2017",
                         ola == 3 ~ "2018",
                         ola == 4 ~ "2019",
                         ola == 6 ~ "2022",
                         ola == 7 ~ "2023"),
         ola = factor(ola, levels = c("2016",
                                        "2017",
                                        "2018",
                                        "2019",
                                        "2022",
                                        "2023")))


df_study1 <- df_study1 %>% 
  group_by(idencuesta) %>% 
  mutate(perc_inequality_mean = mean(perc_inequality, na.rm = T),
         perc_inequality_cwc = perc_inequality - perc_inequality_mean,
         just_inequality_mean = mean(just_inequality, na.rm = T),
         just_inequality_cwc = just_inequality - just_inequality_mean,
         merit_effort_mean = mean(merit_effort, na.rm = T),
         merit_effort_cwc = merit_effort - merit_effort_mean,
         merit_talent_mean = mean(merit_talent, na.rm = T),
         merit_talent_cwc = merit_talent - merit_talent_mean,
         ) %>% 
  ungroup()
```



```{r}
#| echo: false
#| include: false 

m0 <- lmer(mjp ~ 1 + (1 | idencuesta), 
                data = df_study1)

performance::icc(m0, by_group = T)

m1 <- lmer(mjp ~ 1 + ola + (1 | idencuesta),
                data = df_study1)

m1.1 <- lmer(mjp ~ 1 + ola_num + ola_2 + (1 | idencuesta),
                data = df_study1)

m2 <- lmer(mjp ~ 1 + ola_num + ola_2 + (1 + ola_num | idencuesta),
                data = df_study1)

anova(m1.1, m2)

m3 <- lmer(mjp ~ 1 + ola_num + ola_2 + perc_inequality + (1 + ola_num | idencuesta), 
           data = df_study1)

m4 <- lmer(mjp ~ 1 + ola_num + ola_2 + perc_inequality + just_inequality + (1 + ola_num | idencuesta),
                data = df_study1)

m5 <- lmer(mjp ~ 1 + ola_num + ola_2 + perc_inequality + just_inequality + merit_effort + (1 + ola_num | idencuesta),
                data = df_study1)

m6 <- lmer(mjp ~ 1 + ola_num + ola_2 + perc_inequality + just_inequality + merit_effort + merit_talent + (1 + ola_num | idencuesta),
                data = df_study1)


m7 <- lmer(mjp ~ 1 + ola_num + ola_2 + perc_inequality + just_inequality + merit_effort + merit_talent + perc_inequality_mean + just_inequality_mean + merit_effort_mean + merit_talent_mean + (1 + ola_num | idencuesta),
                data = df_study1)

m8 <- lmer(mjp ~ 1 + ola_num + ola_2 + perc_inequality + just_inequality + merit_effort + merit_talent + perc_inequality_mean + just_inequality_mean + merit_effort_mean + merit_talent_mean + educ + quintil1 + ess + ideo + sex + age + (1 + ola_num | idencuesta),
                data = df_study1)

m9 <- lmer(mjp ~ 1 + ola_num + ola_2 + perc_inequality*ola_num + just_inequality + merit_effort + merit_talent + perc_inequality_mean + just_inequality_mean + merit_effort_mean + merit_talent_mean + educ + quintil1 + ess + ideo + sex + age + (1 + perc_inequality +ola_num | idencuesta),
                data = df_study1)

m10 <- lmer(mjp ~ 1 + ola_num + ola_2 + perc_inequality + just_inequality*ola_num + merit_effort + merit_talent + perc_inequality_mean + just_inequality_mean + merit_effort_mean + merit_talent_mean + educ + quintil1 + ess + ideo + sex + age + (1 + just_inequality+ola_num| idencuesta),
                data = df_study1)

m11 <- lmer(mjp ~ 1 + ola_num + ola_2 + perc_inequality + just_inequality + merit_effort*ola_num + merit_talent + perc_inequality_mean + just_inequality_mean + merit_effort_mean + merit_talent_mean + educ + quintil1 + ess + ideo + sex + age + (1 + merit_effort+ola_num | idencuesta),
                data = df_study1)

m12 <- lmer(mjp ~ 1 + ola_num + ola_2 + perc_inequality + just_inequality + merit_effort + merit_talent*ola_num + perc_inequality_mean + just_inequality_mean + merit_effort_mean + merit_talent_mean + educ + quintil1 + ess + ideo + sex + age + (1 + merit_talent +ola_num| idencuesta),
                data = df_study1)
```


```{r}
#| label: tbl-modelos
#| tbl-cap: "Longitudinal multilevel models for market justice preferences"
#| tbl-cap-location: top
#| results: asis
#| echo: false

ccoef <- list(
  "(Intercept)" = "Intercept",
  "ola2017" = "Wave 2017",
  "ola2018" = "Wave 2018",
  "ola2019" = "Wave 2019",
  "ola2022" = "Wave 2022",
  "ola2023" = "Wave 2023",
  ola_num = "Wave",
  ola_2 = "Wave^2",
  perc_inequality = "Perception inequality (WE)",
  just_inequality = "Justification inequality (WE)",
  merit_effort = "Merit: Effort (WE)",
  merit_talent = "Merit: Talent (WE)",
  perc_inequality_mean = "Perception inequality (BE)",
  just_inequality_mean = "Justification inequality (BE)",
  merit_effort_mean = "Merit: Effort (BE)",
  merit_talent_mean = "Merit: Talent (BE)"
  )

texreg::texreg(list(m1, m2, m3, m4, m5, m6, m7, m8),
               custom.model.names = c(paste0("Model ", seq(1:8))),
               caption = NULL,
               stars = c(0.05, 0.01, 0.001),
               custom.coef.map = ccoef,
               digits = 3,
               groups = list("Wave (Ref.= 2016)" = 2:6),
               custom.note = "Note: Cells contain regression coefficients with standard errors in parentheses. %stars.",
               threeparttable = T,
               leading.zero = T,
               float.pos = "H",
               use.packages = F,
               booktabs = T,
               scalebox = 1,
              custom.gof.rows = list("Controls"=c(rep("No",7), "Yes")))


```


Models 3 to 6 incorporate the within-group effects (WE) of the primary independent variables, capturing how individual changes in these variables over time shape the dependent variable. The results in Model 3 suggest that the within effect of perceived economic inequality is negative and statistically significant ($p$ < .001). Specifically, each one-point increase in an individual’s perception of economic inequality between waves is associated with a 0.037 point decrease in market justice preferences. By contrast, in Model 4, the within effect of justifying economic inequality is positive and significant ($\beta$ = 0.100, $p$ < .001), implying that a rise in an individual’s justification of economic inequality over time corresponds to higher market justice preferences. Regarding meritocratic variables, Model 5 indicates that the perception of being rewarded for effort exerts a positive within effect ($\beta$ = 0.107, $p$ < .001). Similarly, Model 6 shows that viewing intelligence and ability (talent) as rewarded is also positively related to market justice preferences ($\beta$ = 0.029, $p$ < .05). Taken together, these results suggest that individuals who increasingly perceive meritocracy—whether through effort or talent—tend to hold stronger market justice preferences.

When examining the between-group effects (BE) in Model 7, which capture differences between individuals in the average of the main variables, a similar pattern emerges. Individuals who perceive higher levels of economic inequality tend to prefer less market justice ($\beta$ = -0.077, $p$ < .001), whereas those who justify economic inequality more strongly exhibit higher market justice preferences ($\beta$ = 0.156, $p$ < .001). Furthermore, the meritocratic perception that effort is rewarded has a positive impact on market justice preferences ($\beta$ = 0.092, $p$ < .05). By contrast, the perception that talent is rewarded shows a negative coefficient ($\beta$ = -0.006), though this relationship is not statistically significant at the 95% confidence level.

Model 8 introduces the control variables. The within- and between-effects of the main predictors retain both their direction and statistical significance, indicating that the associations are robust to adjustment. Regarding the controls, belonging to higher household-income quintiles is associated with stronger market-justice preferences: individuals in the fourth and fifth quintiles score higher than those in the bottom quintile ($\beta$ = 0.093, $p$ < .05; $\beta$ = 0.147, $p$ < .001, respectively). Respondents who did not report their income also express greater support for market justice ($\beta$ = 0.172, $p$ < .01). Political orientation matters as well: compared with those on the left, individuals who place themselves on the right ($\beta$ = 0.246, $p$ < .001) or who declare no political position ($\beta$ = 0.092, $p$ < .01) display higher market-justice preferences. Finally, women exhibit lower market-justice preferences than men ($\beta$ = −0.080, $p$ < .01).


```{r}
#| label: tbl-interactions
#| tbl-cap: "Intereactions for within effects and time"
#| tbl-cap-location: top

ccoef <- list(
  "(Intercept)" = "Intercept",
  "ola_num:perc_inequality" = "Perception inequality (WE) x Wave",
  "ola_num:just_inequality" = "Justification inequality (WE) x Wave",
  "ola_num:merit_effort" = "Merit: Effort (WE) x Wave",
  "ola_num:merit_talent" = "Merit: Talent (WE) x Wave"
  )

texreg::texreg(list(m9,m10,m11,m12),
               custom.model.names = c("Model 9", "Model 10", "Model 11", "Model 12"),
               caption = NULL,
               stars = c(0.05, 0.01, 0.001),
               custom.coef.map = ccoef,
               digits = 3,
               custom.note = "Note: Cells contain regression coefficients with standard errors in parentheses. %stars.",
               threeparttable = T,
               leading.zero = T,
               float.pos = "h!",
               use.packages = F,
               booktabs = T,
               scalebox = 1,
               custom.gof.rows = list("Controls"=c(rep("Yes",4))))
```

